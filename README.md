# üöÄ API Data Sync - Laravel –ø—Ä–æ–µ–∫—Ç

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ API –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ MySQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

---

## üìã –û –ø—Ä–æ–µ–∫—Ç–µ

API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- **–ü—Ä–æ–¥–∞–∂–∏** (Sales): `/api/sales`
- **–ó–∞–∫–∞–∑—ã** (Orders): `/api/orders`  
- **–°–∫–ª–∞–¥—ã** (Stocks): `/api/stocks`
- **–î–æ—Ö–æ–¥—ã** (Incomes): `/api/incomes`

API –∞–¥—Ä–µ—Å: `http://109.73.206.144:6969`

---

## üóÑÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò –ë–ê–ó–´ –î–ê–ù–ù–´–•

### –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π MySQL —Ö–æ—Å—Ç–∏–Ω–≥

**–°–µ—Ä–≤–∏—Å—ã:** FreeMySQLHosting.net –∏–ª–∏ FreeSQLDatabase.com

### –î–∞–Ω–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```
Host: sql12.freemysqlhosting.net
Port: 3306
Database: sql12745123
Username: sql12745123
Password: <–≤–∞—à –ø–∞—Ä–æ–ª—å>
```

### üìä –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü:

| –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã | –û–ø–∏—Å–∞–Ω–∏–µ | –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è |
|------------------|----------|---------------|
| `sales` | –î–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö | id, data, sale_date, external_id, created_at, updated_at |
| `orders` | –î–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–∞–∑–∞—Ö | id, data, order_date, external_id, created_at, updated_at |
| `stocks` | –î–∞–Ω–Ω—ã–µ –æ —Å–∫–ª–∞–¥–∞—Ö | id, data, stock_date, external_id, created_at, updated_at |
| `incomes` | –î–∞–Ω–Ω—ã–µ –æ –¥–æ—Ö–æ–¥–∞—Ö | id, data, income_date, external_id, created_at, updated_at |

**–ü–†–ò–ú–ï–ß–ê–ù–ò–ï:** –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Ö—Ä–∞–Ω—è—Ç –ø–æ–ª–Ω—ã–µ JSON –¥–∞–Ω–Ω—ã–µ –∏–∑ API –≤ –ø–æ–ª–µ `data`.

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

```bash
git clone <–≤–∞—à-repo-url>
cd api-data-sync
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Composer

```bash
composer install
```

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env —Ñ–∞–π–ª

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª –∏ –≤–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```env
DB_CONNECTION=mysql
DB_HOST=sql12.freemysqlhosting.net
DB_PORT=3306
DB_DATABASE=sql12745123
DB_USERNAME=sql12745123
DB_PASSWORD=<–≤–∞—à-–ø–∞—Ä–æ–ª—å>

API_BASE_URL=http://109.73.206.144:6969
API_KEY=E6kUTYrYwZq2tN4QEtyzsbEBk3ie
```

### 4. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã (Migration)

```bash
php artisan migrate
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞—Å—Ç 4 —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö: `sales`, `orders`, `stocks`, `incomes`

---

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ API

```bash
php artisan api:sync
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –∑–∞–≥—Ä—É–∑–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π.

### –ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥

```bash
php artisan api:sync --dateFrom=2024-01-01 --dateTo=2024-01-31
```

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

1. –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
2. –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∑–∞–ø—Ä–æ—Å—ã –∫ API (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞)
3. –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ (–ø–æ 500 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑)
4. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
5. –î—É–±–ª–∏–∫–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è (—á–µ—Ä–µ–∑ updateOrCreate)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
api-data-sync/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ Console/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Commands/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ SyncApiData.php      # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ Models/
‚îÇ       ‚îú‚îÄ‚îÄ Sale.php                 # –ú–æ–¥–µ–ª—å –ø—Ä–æ–¥–∞–∂
‚îÇ       ‚îú‚îÄ‚îÄ Order.php                # –ú–æ–¥–µ–ª—å –∑–∞–∫–∞–∑–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ Stock.php                # –ú–æ–¥–µ–ª—å —Å–∫–ª–∞–¥–æ–≤
‚îÇ       ‚îî‚îÄ‚îÄ Income.php               # –ú–æ–¥–µ–ª—å –¥–æ—Ö–æ–¥–æ–≤
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îî‚îÄ‚îÄ migrations/
‚îÇ       ‚îú‚îÄ‚îÄ 2024_01_01_000001_create_sales_table.php
‚îÇ       ‚îú‚îÄ‚îÄ 2024_01_01_000002_create_orders_table.php
‚îÇ       ‚îú‚îÄ‚îÄ 2024_01_01_000003_create_stocks_table.php
‚îÇ       ‚îî‚îÄ‚îÄ 2024_01_01_000004_create_incomes_table.php
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ database.php                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ .env                             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md                        # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ö–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:

- **id** - –ê–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç ID (Primary Key)
- **data** - JSON —Ñ–æ—Ä–º–∞—Ç (–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ API)
- **{type}_date** - –î–∞—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: sale_date, order_date)
- **external_id** - ID –∏–∑ API (–¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
- **created_at** - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è
- **updated_at** - –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –§–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –∫ API

```
GET /api/sales?dateFrom=2024-01-01&dateTo=2024-01-31&page=1&limit=500&key=E6kUTYrYwZq2tN4QEtyzsbEBk3ie
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è  
‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤  
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫  
‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤  
‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ  

---

## üêõ –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –û—à–∏–±–∫–∞ "Connection refused"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
php artisan config:clear
```

### –û—à–∏–±–∫–∞ "Too many requests"

–í –∫–æ–º–∞–Ω–¥–µ –¥–æ–±–∞–≤–ª–µ–Ω `sleep(1)` –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ API.

### –î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API Key –≤ .env —Ñ–∞–π–ª–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å API

---

## üìû –ü–æ–º–æ—â—å

–ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã:
- –°–æ–∑–¥–∞–π—Ç–µ Issue –Ω–∞ GitHub
- Email: <–≤–∞—à-email>

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö.

---

## üéì –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Laravel

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è:

1. **Migration** - –°–æ–∑–¥–∞–Ω–∏–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. **Model** - –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
3. **Command** - –ü—Ä–æ–≥—Ä–∞–º–º–∞, —Ä–∞–±–æ—Ç–∞—é—â–∞—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å
4. **Artisan** - CLI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Laravel

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Artisan:

```bash
php artisan migrate              # –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã
php artisan migrate:rollback     # –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
php artisan migrate:fresh        # –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
php artisan list                 # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã
```

---

**–£—Å–ø–µ—Ö–æ–≤! üéâ**
